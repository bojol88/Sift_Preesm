/** 
 * @file Core3.c
 * @generated by CPrinter
 * @date Sun May 03 23:32:00 CEST 2015
 */

#include "../include/x86.h"

// Core Global Declaration
extern pthread_barrier_t iter_barrier;
extern int stopThreads;
extern char SharedMem[157560580]; //  size:= 157560580*char
extern uchar *const init_out__octaves__0;  // BuildSS_init_octaves_init_out > BuildSS_octaves size:= 608256*uchar defined in Core0
extern float *const init_out__in__1;  // scaleSpace_init_in_init_out > scaleSpace_in size:= 3649536*float defined in Core0
extern char *const scaleSpace_init_in__scaleSpa__0;  // scaleSpace_init_in > scaleSpace size:= 14598144*char defined in Core0
extern float *const scaleSpace__end_in__0;  // BuildSS_scaleSpace > BuildSS_end_scaleSpace_end_in size:= 3649536*float defined in Core0

// Core Global Definitions
char *const FIFO_Head_BuildOB_end_octave__0 = (char*) (SharedMem+57706144);  // FIFO_Head_BuildOB_end_octaves > BuildSS_init_octaves size:= 608256*char
char *const FIFO_Head_BuildSS_end_scaleS__0 = (char*) (SharedMem+58447524);  // FIFO_Head_BuildSS_end_scaleSpace > scaleSpace_init_in size:= 14598144*char
sem_t sem_4_SSRE;

void *computationThread_Core3(void *arg){
	// Initialisation(s)
	fifoInit(FIFO_Head_BuildOB_end_octave__0, 608256*sizeof(char), NULL, 0);
	fifoInit(FIFO_Head_BuildSS_end_scaleS__0, 14598144*sizeof(char), NULL, 0);
	sem_init(&sem_4_SSRE,0,0/*init_val*/); // scaleSpace_init_in > scaleSpace

	// Begin the execution loop 
	while(1){
		pthread_barrier_wait(&iter_barrier);
		if(stopThreads){
			pthread_exit(NULL);
		}
		fifoPop(init_out__octaves__0, FIFO_Head_BuildOB_end_octave__0, 608256*sizeof(char), NULL, 0);
		fifoPop(init_out__in__1, FIFO_Head_BuildSS_end_scaleS__0, 14598144*sizeof(char), NULL, 0);
		sendStart(&sem_4_SSRE/*ID*/); // Core3 > Core2: scaleSpace_init_in__scaleSpa__0 
		sendEnd(); // Core3 > Core2: scaleSpace_init_in__scaleSpa__0 
		buildSS(init_out__octaves__0,scaleSpace__end_in__0,352/*xsize*/,288/*ysize*/); // BuildSS
		fifoPush(scaleSpace__end_in__0, FIFO_Head_BuildSS_end_scaleS__0, 14598144*sizeof(char), NULL, 0);
	}
}
