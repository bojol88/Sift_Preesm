/** 
 * @file Core2.c
 * @generated by CPrinter
 * @date Fri May 08 16:26:34 CEST 2015
 */

#include "../include/x86.h"

// Core Global Declaration
extern pthread_barrier_t iter_barrier;
extern int stopThreads;
extern char SharedMem[172744688]; //  size:= 172744688*char
extern uchar *const init_out__img__1;  // BuildOB_init_img_init_out > BuildOB_img size:= 101376*uchar defined in Core0
extern char *const BuildOB_init_img__BuildOB__0;  // BuildOB_init_img > BuildOB size:= 101376*char defined in Core0
extern uchar *const init_out__octaves__3;  // BuildSS_0_init_octaves_init_out > BuildSS_0_octaves size:= 101376*uchar defined in Core0
extern char *const BuildSS_0_init_octaves__Buil__0;  // BuildSS_0_init_octaves > BuildSS_0 size:= 101376*char defined in Core0
extern char *const BuildSS_3_init_octaves__Buil__0;  // BuildSS_3_init_octaves > BuildSS_3 size:= 101376*char defined in Core0
extern sem_t sem_3_SSRE; 
extern uchar *const init_out__octaves__4;  // BuildSS_4_init_octaves_init_out > BuildSS_4_octaves size:= 101376*uchar defined in Core0
extern char *const BuildSS_4_init_octaves__Buil__0;  // BuildSS_4_init_octaves > BuildSS_4 size:= 101376*char defined in Core0
extern char *const Init__Init_end_sigmas__0;  // Init > Init_end_sigmas size:= 144*char defined in Core0
extern sem_t sem_5_SSRE; 
extern char *const Init__Init_end_octavesH_g__0;  // Init > Init_end_octavesH_g size:= 24*char defined in Core0
extern sem_t sem_6_SSRE; 
extern char *const Init__Init_end_octavesW_g__0;  // Init > Init_end_octavesW_g size:= 24*char defined in Core0
extern sem_t sem_7_SSRE; 
extern pointList *const init_out__keyPointList__1;  // Orientation_init_keyPointList_init_out > Orientation_keyPointList size:= 1*pointList defined in Core0
extern float *const init_out__scaleSpace__0;  // Orientation_init_scaleSpace_init_out > Orientation_scaleSpace size:= 3649536*float defined in Core0
extern uchar *const y__end_in__0;  // ReadYUV_y > ReadYUV_end_y_end_in size:= 101376*uchar defined in Core0
extern char *const ReadYUV__ReadYUV_end_y__0;  // ReadYUV > ReadYUV_end_y size:= 101376*char defined in Core0
extern uchar *const init_out__b__0;  // WritePGM_init_b_init_out > WritePGM_b size:= 101376*uchar defined in Core0
extern uchar *const init_out__g__0;  // WritePGM_init_g_init_out > WritePGM_g size:= 101376*uchar defined in Core0
extern uchar *const init_out__r__0;  // WritePGM_init_r_init_out > WritePGM_r size:= 101376*uchar defined in Core0
extern float *const init_out__in__3;  // sigmas_init_in_init_out > sigmas_in size:= 36*float defined in Core0
extern char *const octavesW__Orientation__0;  // octavesW > Orientation size:= 24*char defined in Core0
extern sem_t sem_9_SSRE; 
extern float *const out2__sigmas__0;  // sigmas_out2 > Orientation_sigmas size:= 36*float defined in Core0
extern float *const out3__end_in__0;  // sigmas_out3 > sigmas_end_out3_end_in size:= 36*float defined in Core0
extern char *const FIFO_Head_sigmas_end_out3__R__0;  // FIFO_Head_sigmas_end_out3 > Render_init_sigmas size:= 144*char defined in Core0
extern char *const FIFO_Head_Init_end_octavesH___0;  // FIFO_Head_Init_end_octavesH_g > octavesH_init_in size:= 24*char defined in Core0
extern int *const octavesH_g__end_in__0;  // Init_octavesH_g > Init_end_octavesH_g_end_in size:= 6*int defined in Core0
extern char *const FIFO_Head_Init_end_octavesW___0;  // FIFO_Head_Init_end_octavesW_g > octavesW_init_in size:= 24*char defined in Core0
extern int *const octavesW_g__end_in__0;  // Init_octavesW_g > Init_end_octavesW_g_end_in size:= 6*int defined in Core0
extern float *const sigmas__end_in__0;  // Init_sigmas > Init_end_sigmas_end_in size:= 36*float defined in Core0
extern char *const explode_ParalSS_Paral__Build__4;  // explode_ParalSS_Paral > BuildSS_3 size:= 4*char defined in Core0
extern sem_t sem_12_SSRE; 
extern char *const BuildSS_0__BuildSS_0_end_sca__0;  // BuildSS_0 > BuildSS_0_end_scaleSpace size:= 2433024*char defined in Core0
extern sem_t sem_15_SSRE; 
extern char *const BuildSS_2__BuildSS_2_end_sca__0;  // BuildSS_2 > BuildSS_2_end_scaleSpace size:= 2433024*char defined in Core0
extern sem_t sem_16_SSRE; 
extern uchar *const init_out__octaves__2;  // BuildSS_3_init_octaves_init_out > BuildSS_3_octaves size:= 101376*uchar defined in Core0
extern float *const scaleSpace__end_in__2;  // BuildSS_3_scaleSpace > BuildSS_3_end_scaleSpace_end_in size:= 608256*float defined in Core0
extern int *const Paral_3__Paral__0;  // explode_ParalSS_Paral_Paral_3 > BuildSS_3_Paral size:= 1*int defined in Core0
extern char *const explode_BuildOB_octaves__exp__1;  // explode_BuildOB_octaves > explode_BuildOB_octaves_end_octaves_405504 size:= 101376*char defined in Core0
extern sem_t sem_17_SSRE; 
extern uchar *const octaves_405504__end_in__0;  // explode_BuildOB_octaves_octaves_405504 > explode_BuildOB_octaves_end_octaves_405504_end_in size:= 101376*uchar defined in Core0
extern pointList *const keyPointListCP__end_in__0;  // Orientation_keyPointListCP > Orientation_end_keyPointListCP_end_in size:= 1*pointList defined in Core0
extern int *const out5__octavesW__0;  // octavesW_out5 > Orientation_octavesW size:= 6*int defined in Core0
extern char *const scaleSpace__scaleSpace_end_o__0;  // scaleSpace > scaleSpace_end_out2 size:= 14598144*char defined in Core0
extern sem_t sem_18_SSRE; 
extern char *const FIFO_Head_Orientation_end_ke__0;  // FIFO_Head_Orientation_end_keyPointListCP > Render_init_keyPointList size:= 12004*char defined in Core0
extern float *const out2__end_in__1;  // scaleSpace_out2 > scaleSpace_end_out2_end_in size:= 3649536*float defined in Core0
extern char *const FIFO_Head_BuildSS_0_end_scal__0;  // FIFO_Head_BuildSS_0_end_scaleSpace > implode_scaleSpace_in_init_in_0 size:= 2433024*char defined in Core0
extern float *const scaleSpace__end_in__0;  // BuildSS_0_scaleSpace > BuildSS_0_end_scaleSpace_end_in size:= 608256*float defined in Core0
extern char *const FIFO_Head_BuildSS_2_end_scal__0;  // FIFO_Head_BuildSS_2_end_scaleSpace > implode_scaleSpace_in_init_in_1216512 size:= 2433024*char defined in Core0
extern float *const scaleSpace__end_in__3;  // BuildSS_2_scaleSpace > BuildSS_2_end_scaleSpace_end_in size:= 608256*float defined in Core0
extern char *const FIFO_Head_BuildSS_3_end_scal__0;  // FIFO_Head_BuildSS_3_end_scaleSpace > implode_scaleSpace_in_init_in_1824768 size:= 2433024*char defined in Core0

// Core Global Definitions
char *const FIFO_Head_Img_end_out1__Buil__0 = (char*) (SharedMem+35739336);  // FIFO_Head_Img_end_out1 > BuildOB_init_img size:= 101376*char
sem_t sem_0_SSRE;
char *const FIFO_Head_explode_BuildOB_oc__5 = (char*) (SharedMem+132266996);  // FIFO_Head_explode_BuildOB_octaves_end_octaves_0 > BuildSS_0_init_octaves size:= 101376*char
sem_t sem_1_SSRE;
char *const FIFO_Head_explode_BuildOB_oc__1 = (char*) (SharedMem+154569908);  // FIFO_Head_explode_BuildOB_octaves_end_octaves_405504 > BuildSS_4_init_octaves size:= 101376*char
sem_t sem_4_SSRE;
char *const FIFO_Head_Extreme_end_keyPoi__0 = (char*) (SharedMem+8018672);  // FIFO_Head_Extreme_end_keyPointList > Orientation_init_keyPointList size:= 12004*char
char *const FIFO_Head_scaleSpace_end_out__0 = (char*) (SharedMem+38273764);  // FIFO_Head_scaleSpace_end_out2 > Orientation_init_scaleSpace size:= 14598144*char
char *const FIFO_Body_scaleSpace_end_out__0 = (char*) (SharedMem+157943744);  // FIFO_Body_scaleSpace_end_out2 > Orientation_init_scaleSpace size:= 14598144*char
sem_t sem_8_SSRE;
char *const FIFO_Head_Render_end_b__Writ__0 = (char*) (SharedMem+87846700);  // FIFO_Head_Render_end_b > WritePGM_init_b size:= 101376*char
char *const FIFO_Head_Render_end_g__Writ__0 = (char*) (SharedMem+132571124);  // FIFO_Head_Render_end_g > WritePGM_init_g size:= 101376*char
char *const FIFO_Head_Render_end_r__Writ__0 = (char*) (SharedMem+33103268);  // FIFO_Head_Render_end_r > WritePGM_init_r size:= 101376*char
char *const FIFO_Head_Init_end_sigmas__s__0 = (char*) (SharedMem+33306168);  // FIFO_Head_Init_end_sigmas > sigmas_init_in size:= 144*char

void *computationThread_Core2(void *arg){
	// Initialisation(s)
	fifoInit(FIFO_Head_Img_end_out1__Buil__0, 101376*sizeof(char), NULL, 0);
	sem_init(&sem_0_SSRE,0,0/*init_val*/); // BuildOB_init_img > BuildOB
	fifoInit(FIFO_Head_explode_BuildOB_oc__5, 101376*sizeof(char), NULL, 0);
	sem_init(&sem_1_SSRE,0,0/*init_val*/); // BuildSS_0_init_octaves > BuildSS_0
	fifoInit(FIFO_Head_explode_BuildOB_oc__1, 101376*sizeof(char), NULL, 0);
	sem_init(&sem_4_SSRE,0,0/*init_val*/); // BuildSS_4_init_octaves > BuildSS_4
	fifoInit(FIFO_Head_Extreme_end_keyPoi__0, 12004*sizeof(char), NULL, 0);
	fifoInit(FIFO_Head_scaleSpace_end_out__0, 14598144*sizeof(char), FIFO_Body_scaleSpace_end_out__0, 14598144*sizeof(char));
	initReadYUV(352/*xsize*/,288/*ysize*/); // ReadYUV
	sem_init(&sem_8_SSRE,0,0/*init_val*/); // ReadYUV > ReadYUV_end_y
	fifoInit(FIFO_Head_Render_end_b__Writ__0, 101376*sizeof(char), NULL, 0);
	fifoInit(FIFO_Head_Render_end_g__Writ__0, 101376*sizeof(char), NULL, 0);
	fifoInit(FIFO_Head_Render_end_r__Writ__0, 101376*sizeof(char), NULL, 0);
	fifoInit(FIFO_Head_Init_end_sigmas__s__0, 144*sizeof(char), NULL, 0);

	// Begin the execution loop 
	while(1){
		pthread_barrier_wait(&iter_barrier);
		if(stopThreads){
			pthread_exit(NULL);
		}
		fifoPop(init_out__img__1, FIFO_Head_Img_end_out1__Buil__0, 101376*sizeof(char), NULL, 0);
		sendStart(&sem_0_SSRE/*ID*/); // Core2 > Core0: BuildOB_init_img__BuildOB__0 
		sendEnd(); // Core2 > Core0: BuildOB_init_img__BuildOB__0 
		fifoPop(init_out__octaves__3, FIFO_Head_explode_BuildOB_oc__5, 101376*sizeof(char), NULL, 0);
		sendStart(&sem_1_SSRE/*ID*/); // Core2 > Core3: BuildSS_0_init_octaves__Buil__0 
		sendEnd(); // Core2 > Core3: BuildSS_0_init_octaves__Buil__0 
		receiveStart(); // Core3 > Core2: BuildSS_3_init_octaves__Buil__0 
		receiveEnd(&sem_3_SSRE/*ID*/); // Core3 > Core2: BuildSS_3_init_octaves__Buil__0 
		fifoPop(init_out__octaves__4, FIFO_Head_explode_BuildOB_oc__1, 101376*sizeof(char), NULL, 0);
		sendStart(&sem_4_SSRE/*ID*/); // Core2 > Core3: BuildSS_4_init_octaves__Buil__0 
		sendEnd(); // Core2 > Core3: BuildSS_4_init_octaves__Buil__0 
		receiveStart(); // Core0 > Core2: Init__Init_end_sigmas__0 
		receiveEnd(&sem_5_SSRE/*ID*/); // Core0 > Core2: Init__Init_end_sigmas__0 
		receiveStart(); // Core0 > Core2: Init__Init_end_octavesH_g__0 
		receiveEnd(&sem_6_SSRE/*ID*/); // Core0 > Core2: Init__Init_end_octavesH_g__0 
		receiveStart(); // Core0 > Core2: Init__Init_end_octavesW_g__0 
		receiveEnd(&sem_7_SSRE/*ID*/); // Core0 > Core2: Init__Init_end_octavesW_g__0 
		fifoPop(init_out__keyPointList__1, FIFO_Head_Extreme_end_keyPoi__0, 12004*sizeof(char), NULL, 0);
		fifoPop(init_out__scaleSpace__0, FIFO_Head_scaleSpace_end_out__0, 14598144*sizeof(char), FIFO_Body_scaleSpace_end_out__0, 14598144*sizeof(char));
		readYUV(352/*xsize*/,288/*ysize*/,y__end_in__0); // ReadYUV
		sendStart(&sem_8_SSRE/*ID*/); // Core2 > Core0: ReadYUV__ReadYUV_end_y__0 
		sendEnd(); // Core2 > Core0: ReadYUV__ReadYUV_end_y__0 
		fifoPop(init_out__b__0, FIFO_Head_Render_end_b__Writ__0, 101376*sizeof(char), NULL, 0);
		fifoPop(init_out__g__0, FIFO_Head_Render_end_g__Writ__0, 101376*sizeof(char), NULL, 0);
		fifoPop(init_out__r__0, FIFO_Head_Render_end_r__Writ__0, 101376*sizeof(char), NULL, 0);
		fifoPop(init_out__in__3, FIFO_Head_Init_end_sigmas__s__0, 144*sizeof(char), NULL, 0);
		receiveStart(); // Core0 > Core2: octavesW__Orientation__0 
		receiveEnd(&sem_9_SSRE/*ID*/); // Core0 > Core2: octavesW__Orientation__0 
		// Broadcast sigmas
		{
			memcpy(out2__sigmas__0+0, init_out__in__3+0, 36*sizeof(float));
			memcpy(out3__end_in__0+0, init_out__in__3+0, 36*sizeof(float));
		}
		fifoPush(out3__end_in__0, FIFO_Head_sigmas_end_out3__R__0, 144*sizeof(char), NULL, 0);
		fifoPush(octavesH_g__end_in__0, FIFO_Head_Init_end_octavesH___0, 24*sizeof(char), NULL, 0);
		fifoPush(octavesW_g__end_in__0, FIFO_Head_Init_end_octavesW___0, 24*sizeof(char), NULL, 0);
		fifoPush(sigmas__end_in__0, FIFO_Head_Init_end_sigmas__s__0, 144*sizeof(char), NULL, 0);
		write_ppm(init_out__r__0,init_out__g__0,init_out__b__0,352/*w*/,288/*h*/); // WritePGM
		receiveStart(); // Core0 > Core2: explode_ParalSS_Paral__Build__4 
		receiveEnd(&sem_12_SSRE/*ID*/); // Core0 > Core2: explode_ParalSS_Paral__Build__4 
		receiveStart(); // Core3 > Core2: BuildSS_0__BuildSS_0_end_sca__0 
		receiveEnd(&sem_15_SSRE/*ID*/); // Core3 > Core2: BuildSS_0__BuildSS_0_end_sca__0 
		receiveStart(); // Core1 > Core2: BuildSS_2__BuildSS_2_end_sca__0 
		receiveEnd(&sem_16_SSRE/*ID*/); // Core1 > Core2: BuildSS_2__BuildSS_2_end_sca__0 
		buildSS(init_out__octaves__2,scaleSpace__end_in__2,352/*xsize*/,288/*ysize*/,Paral_3__Paral__0); // BuildSS_3
		receiveStart(); // Core0 > Core2: explode_BuildOB_octaves__exp__1 
		receiveEnd(&sem_17_SSRE/*ID*/); // Core0 > Core2: explode_BuildOB_octaves__exp__1 
		fifoPush(octaves_405504__end_in__0, FIFO_Head_explode_BuildOB_oc__1, 101376*sizeof(char), NULL, 0);
		orientation(init_out__keyPointList__1,keyPointListCP__end_in__0,init_out__scaleSpace__0,out2__sigmas__0,out5__octavesW__0); // Orientation
		receiveStart(); // Core0 > Core2: scaleSpace__scaleSpace_end_o__0 
		receiveEnd(&sem_18_SSRE/*ID*/); // Core0 > Core2: scaleSpace__scaleSpace_end_o__0 
		fifoPush(keyPointListCP__end_in__0, FIFO_Head_Orientation_end_ke__0, 12004*sizeof(char), NULL, 0);
		fifoPush(out2__end_in__1, FIFO_Head_scaleSpace_end_out__0, 14598144*sizeof(char), FIFO_Body_scaleSpace_end_out__0, 14598144*sizeof(char));
		fifoPush(scaleSpace__end_in__0, FIFO_Head_BuildSS_0_end_scal__0, 2433024*sizeof(char), NULL, 0);
		fifoPush(scaleSpace__end_in__3, FIFO_Head_BuildSS_2_end_scal__0, 2433024*sizeof(char), NULL, 0);
		fifoPush(scaleSpace__end_in__2, FIFO_Head_BuildSS_3_end_scal__0, 2433024*sizeof(char), NULL, 0);
	}
}
